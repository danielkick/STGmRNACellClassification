plot_grid(plotlist = list(
ggplot(data4[data4$type == "SEQ", ], aes(x = Cell, y = ChAT, fill = Cell)) +
geom_boxplot() +
geom_point(size = 2, shape = 1, na.rm = TRUE) + theme(legend.position = "")+     scale_fill_brewer(type = "qual", palette = iii),
ggplot(data4[data4$type == "PCR", ], aes(x = Cell, y = ChAT, fill = Cell)) +
geom_boxplot() +
geom_point(size = 2, shape = 1, na.rm = TRUE) + theme(legend.position = "")+     scale_fill_brewer(type = "qual", palette = iii),
ggplot(data4[data4$type == "SEQ", ], aes(x = Cell, y = vAChT, fill = Cell)) +
geom_boxplot() +
geom_point(size = 2, shape = 1, na.rm = TRUE) + theme(legend.position = "")+     scale_fill_brewer(type = "qual", palette = iii),
ggplot(data4[data4$type == "PCR", ], aes(x = Cell, y = vAChT, fill = Cell)) +
geom_boxplot() +
geom_point(size = 2, shape = 1, na.rm = TRUE) + theme(legend.position = "")+     scale_fill_brewer(type = "qual", palette = iii),
ggplot(data4[data4$type == "SEQ", ], aes(x = Cell, y = NMDA2B, fill = Cell)) +
geom_boxplot() +
geom_point(size = 2, shape = 1, na.rm = TRUE) + theme(legend.position = "")+     scale_fill_brewer(type = "qual", palette = iii),
ggplot(data4[data4$type == "PCR", ], aes(x = Cell, y = NMDA2B, fill = Cell)) +
geom_boxplot() +
geom_point(size = 2, shape = 1, na.rm = TRUE) + theme(legend.position = "")+     scale_fill_brewer(type = "qual", palette = iii),
ggplot(data4[data4$type == "SEQ", ], aes(x = Cell, y = KCNK1, fill = Cell)) +
geom_boxplot() +
geom_point(size = 2, shape = 1, na.rm = TRUE) + theme(legend.position = "")+     scale_fill_brewer(type = "qual", palette = iii),
ggplot(data4[data4$type == "PCR", ], aes(x = Cell, y = KCNK1, fill = Cell)) +
geom_boxplot() +
geom_point(size = 2, shape = 1, na.rm = TRUE) + theme(legend.position = "")+    scale_fill_brewer(type = "qual", palette = iii)
), nrow = 2, ncol = 4)
library(tidyverse)
library(cowplot)
# list.files("S:/Data_Daniel/ActiveProjects/stgmcc/inst/extdata/")
#
# "Preamp_vs_noamp.csv"
# "STG-4genesSeqComp-qPCR.csv"
# "STG-4genesSeqComp-SEQ.csv"
# # "STG_LC_Absolute_Counts_allSTG-GM2f.csv"
#
#
#
#
data1 <- read.csv("S:/Data_Daniel/ActiveProjects/stgmcc/inst/extdata/Preamp_vs_noamp.csv", header = TRUE)
names(data1) <- c("Target", "Sample", "Unamp", "Amp")
plt1 <- ggplot(data1, aes(x = Unamp, y = Amp, color = Target))+
geom_point(size = 5, shape = 1, na.rm = TRUE)+
labs(x = "Unamplified Cq", y = "Amplified Cq")+
xlim(29,37)+
ylim(17,27)
#geom_smooth(method=lm)
plot(plt1)
plt2 <- ggplot(data1, aes(x = Unamp, y = Amp))+
geom_point(size = 5, shape = 1, na.rm = TRUE)+
labs(x = "Unamplified Cq", y = "Amplified Cq")+
xlim(29,37)+
ylim(17,27)+
geom_smooth(method=lm)
plot(plt2)
corrPRE <- cor(data1[,3:4], use="complete.obs", method="pearson")
data2 <- read.csv("S:/Data_Daniel/ActiveProjects/stgmcc/inst/extdata/STG-4genesSeqComp-qPCR.csv", header = TRUE)
data3 <- read.csv("S:/Data_Daniel/ActiveProjects/stgmcc/inst/extdata/STG-4genesSeqComp-SEQ.csv", header = TRUE)
data3 <- data3[, !(names(data3) %in% c("KCNK1",  "NMDA2B", "ChAT", "vAChT"))]
names(data2)[1] <- names(data3)[1] <- "Cell"
names(data3) <- c("Cell", "Sample", "vAChT", "NMDA2B", "ChAT", "KCNK1")
data2$type <- "PCR"
data3$type <- "SEQ"
data4 <- full_join(data2, data3)
# data4 <- gather(data4, "target", "Count", 3:6)
# data4 <- data4[, -2]
# ggplot(data4, aes(x = type, y = Count))+
#   geom_point(size = 5, shape = 1, na.rm = TRUE)+
#   facet_grid(Cell ~ target)
#   # labs(x = "Unamplified Cq", y = "Amplified Cq")+
#   # xlim(29,37)+
#   # ylim(17,27)+
#   # geom_smooth(method=lm)
iii <- 4#3,6
plot_grid(plotlist = list(
ggplot(data4[data4$type == "SEQ", ], aes(x = Cell, y = ChAT, fill = Cell)) +
geom_boxplot() +
geom_point(size = 2, shape = 1, na.rm = TRUE) + theme(legend.position = "")+     scale_fill_brewer(type = "qual", palette = iii),
ggplot(data4[data4$type == "PCR", ], aes(x = Cell, y = ChAT, fill = Cell)) +
geom_boxplot() +
geom_point(size = 2, shape = 1, na.rm = TRUE) + theme(legend.position = "")+     scale_fill_brewer(type = "qual", palette = iii),
ggplot(data4[data4$type == "SEQ", ], aes(x = Cell, y = vAChT, fill = Cell)) +
geom_boxplot() +
geom_point(size = 2, shape = 1, na.rm = TRUE) + theme(legend.position = "")+     scale_fill_brewer(type = "qual", palette = iii),
ggplot(data4[data4$type == "PCR", ], aes(x = Cell, y = vAChT, fill = Cell)) +
geom_boxplot() +
geom_point(size = 2, shape = 1, na.rm = TRUE) + theme(legend.position = "")+     scale_fill_brewer(type = "qual", palette = iii),
ggplot(data4[data4$type == "SEQ", ], aes(x = Cell, y = NMDA2B, fill = Cell)) +
geom_boxplot() +
geom_point(size = 2, shape = 1, na.rm = TRUE) + theme(legend.position = "")+     scale_fill_brewer(type = "qual", palette = iii),
ggplot(data4[data4$type == "PCR", ], aes(x = Cell, y = NMDA2B, fill = Cell)) +
geom_boxplot() +
geom_point(size = 2, shape = 1, na.rm = TRUE) + theme(legend.position = "")+     scale_fill_brewer(type = "qual", palette = iii),
ggplot(data4[data4$type == "SEQ", ], aes(x = Cell, y = KCNK1, fill = Cell)) +
geom_boxplot() +
geom_point(size = 2, shape = 1, na.rm = TRUE) + theme(legend.position = "")+     scale_fill_brewer(type = "qual", palette = iii),
ggplot(data4[data4$type == "PCR", ], aes(x = Cell, y = KCNK1, fill = Cell)) +
geom_boxplot() +
geom_point(size = 2, shape = 1, na.rm = TRUE) + theme(legend.position = "")+    scale_fill_brewer(type = "qual", palette = iii)
), nrow = 2, ncol = 4)
iii <- 3#3,6
plot_grid(plotlist = list(
ggplot(data4[data4$type == "SEQ", ], aes(x = Cell, y = ChAT, fill = Cell)) +
geom_boxplot() +
geom_point(size = 2, shape = 1, na.rm = TRUE) + theme(legend.position = "")+     scale_fill_brewer(type = "qual", palette = iii),
ggplot(data4[data4$type == "PCR", ], aes(x = Cell, y = ChAT, fill = Cell)) +
geom_boxplot() +
geom_point(size = 2, shape = 1, na.rm = TRUE) + theme(legend.position = "")+     scale_fill_brewer(type = "qual", palette = iii),
ggplot(data4[data4$type == "SEQ", ], aes(x = Cell, y = vAChT, fill = Cell)) +
geom_boxplot() +
geom_point(size = 2, shape = 1, na.rm = TRUE) + theme(legend.position = "")+     scale_fill_brewer(type = "qual", palette = iii),
ggplot(data4[data4$type == "PCR", ], aes(x = Cell, y = vAChT, fill = Cell)) +
geom_boxplot() +
geom_point(size = 2, shape = 1, na.rm = TRUE) + theme(legend.position = "")+     scale_fill_brewer(type = "qual", palette = iii),
ggplot(data4[data4$type == "SEQ", ], aes(x = Cell, y = NMDA2B, fill = Cell)) +
geom_boxplot() +
geom_point(size = 2, shape = 1, na.rm = TRUE) + theme(legend.position = "")+     scale_fill_brewer(type = "qual", palette = iii),
ggplot(data4[data4$type == "PCR", ], aes(x = Cell, y = NMDA2B, fill = Cell)) +
geom_boxplot() +
geom_point(size = 2, shape = 1, na.rm = TRUE) + theme(legend.position = "")+     scale_fill_brewer(type = "qual", palette = iii),
ggplot(data4[data4$type == "SEQ", ], aes(x = Cell, y = KCNK1, fill = Cell)) +
geom_boxplot() +
geom_point(size = 2, shape = 1, na.rm = TRUE) + theme(legend.position = "")+     scale_fill_brewer(type = "qual", palette = iii),
ggplot(data4[data4$type == "PCR", ], aes(x = Cell, y = KCNK1, fill = Cell)) +
geom_boxplot() +
geom_point(size = 2, shape = 1, na.rm = TRUE) + theme(legend.position = "")+    scale_fill_brewer(type = "qual", palette = iii)
), nrow = 2, ncol = 4)
head(data4)
data4 <- data4[,-2]
data4[data4$type == "PCR", 2]
head(data4)
i=2
mean(data4[data4$type == "PCR" &
data4$Cell == cell, i])
cell = LP
cell = "LP"
mean(data4[data4$type == "PCR" &
data4$Cell == cell, i])
for (cell in unique(data4$Cell)){
for (i in 2:5){
data4[data4$type == "PCR" & data4$Cell == cell, i] <- mean(data4[data4$type == "PCR" & data4$Cell == cell, i])
data4[data4$type == "SEQ" & data4$Cell == cell, i] <- mean(data4[data4$type == "SEQ" & data4$Cell == cell, i])
}
}
head(data4)
?mean
# list.files("S:/Data_Daniel/ActiveProjects/stgmcc/inst/extdata/")
#
# "Preamp_vs_noamp.csv"
# "STG-4genesSeqComp-qPCR.csv"
# "STG-4genesSeqComp-SEQ.csv"
# # "STG_LC_Absolute_Counts_allSTG-GM2f.csv"
#
#
#
#
data1 <- read.csv("S:/Data_Daniel/ActiveProjects/stgmcc/inst/extdata/Preamp_vs_noamp.csv", header = TRUE)
names(data1) <- c("Target", "Sample", "Unamp", "Amp")
plt1 <- ggplot(data1, aes(x = Unamp, y = Amp, color = Target))+
geom_point(size = 5, shape = 1, na.rm = TRUE)+
labs(x = "Unamplified Cq", y = "Amplified Cq")+
xlim(29,37)+
ylim(17,27)
#geom_smooth(method=lm)
plot(plt1)
plt2 <- ggplot(data1, aes(x = Unamp, y = Amp))+
geom_point(size = 5, shape = 1, na.rm = TRUE)+
labs(x = "Unamplified Cq", y = "Amplified Cq")+
xlim(29,37)+
ylim(17,27)+
geom_smooth(method=lm)
plot(plt2)
corrPRE <- cor(data1[,3:4], use="complete.obs", method="pearson")
data2 <- read.csv("S:/Data_Daniel/ActiveProjects/stgmcc/inst/extdata/STG-4genesSeqComp-qPCR.csv", header = TRUE)
data3 <- read.csv("S:/Data_Daniel/ActiveProjects/stgmcc/inst/extdata/STG-4genesSeqComp-SEQ.csv", header = TRUE)
data3 <- data3[, !(names(data3) %in% c("KCNK1",  "NMDA2B", "ChAT", "vAChT"))]
names(data2)[1] <- names(data3)[1] <- "Cell"
names(data3) <- c("Cell", "Sample", "vAChT", "NMDA2B", "ChAT", "KCNK1")
data2$type <- "PCR"
data3$type <- "SEQ"
data4 <- full_join(data2, data3)
# data4 <- gather(data4, "target", "Count", 3:6)
# data4 <- data4[, -2]
# ggplot(data4, aes(x = type, y = Count))+
#   geom_point(size = 5, shape = 1, na.rm = TRUE)+
#   facet_grid(Cell ~ target)
#   # labs(x = "Unamplified Cq", y = "Amplified Cq")+
#   # xlim(29,37)+
#   # ylim(17,27)+
#   # geom_smooth(method=lm)
plot_grid(plotlist = list(
ggplot(data4[data4$type == "SEQ", ], aes(x = Cell, y = ChAT, fill = Cell)) +
geom_boxplot() +
geom_point(size = 2, shape = 1, na.rm = TRUE) + theme(legend.position = "")+     scale_fill_brewer(type = "qual", palette = 3),
ggplot(data4[data4$type == "PCR", ], aes(x = Cell, y = ChAT, fill = Cell)) +
geom_boxplot() +
geom_point(size = 2, shape = 1, na.rm = TRUE) + theme(legend.position = "")+     scale_fill_brewer(type = "qual", palette = 3),
ggplot(data4[data4$type == "SEQ", ], aes(x = Cell, y = vAChT, fill = Cell)) +
geom_boxplot() +
geom_point(size = 2, shape = 1, na.rm = TRUE) + theme(legend.position = "")+     scale_fill_brewer(type = "qual", palette = 3),
ggplot(data4[data4$type == "PCR", ], aes(x = Cell, y = vAChT, fill = Cell)) +
geom_boxplot() +
geom_point(size = 2, shape = 1, na.rm = TRUE) + theme(legend.position = "")+     scale_fill_brewer(type = "qual", palette = 3),
ggplot(data4[data4$type == "SEQ", ], aes(x = Cell, y = NMDA2B, fill = Cell)) +
geom_boxplot() +
geom_point(size = 2, shape = 1, na.rm = TRUE) + theme(legend.position = "")+     scale_fill_brewer(type = "qual", palette = 3),
ggplot(data4[data4$type == "PCR", ], aes(x = Cell, y = NMDA2B, fill = Cell)) +
geom_boxplot() +
geom_point(size = 2, shape = 1, na.rm = TRUE) + theme(legend.position = "")+     scale_fill_brewer(type = "qual", palette = 3),
ggplot(data4[data4$type == "SEQ", ], aes(x = Cell, y = KCNK1, fill = Cell)) +
geom_boxplot() +
geom_point(size = 2, shape = 1, na.rm = TRUE) + theme(legend.position = "")+     scale_fill_brewer(type = "qual", palette = 3),
ggplot(data4[data4$type == "PCR", ], aes(x = Cell, y = KCNK1, fill = Cell)) +
geom_boxplot() +
geom_point(size = 2, shape = 1, na.rm = TRUE) + theme(legend.position = "")+    scale_fill_brewer(type = "qual", palette = 3)
), nrow = 2, ncol = 4)
data4 <- data4[,-2]
for (cell in unique(data4$Cell)){
for (i in 2:5){
data4[data4$type == "PCR" & data4$Cell == cell, i] <- mean(data4[data4$type == "PCR" & data4$Cell == cell, i], na.rm = T)
data4[data4$type == "SEQ" & data4$Cell == cell, i] <- mean(data4[data4$type == "SEQ" & data4$Cell == cell, i], na.rm = T)
}
}
head(data4)
data4 <- data4[!duplicated(data4),]
head(data4)
data4.seq <- data4[data4$type == "SEQ", ]
data4.pcr <- data4[data4$type == "PCR", ]
head(data4.seq)
gather(data4, target, mean, 2:5)
data5 <- gather(data4, target, mean, 2:5)
head(data5)
ggplot(data5, aes(x = type, y = mean, color = Cell))+
geom_line()
ggplot(data5, aes(x = type, y = mean, group = Cell))+
geom_line()
ggplot(data5, aes(x = type, y = mean, group = Cell))+
geom_line()+
facet_grid(.~Cell)
ggplot(data5, aes(x = type, y = mean, group = Cell))+
geom_line()+
facet_grid(.~target)
ggplot(data5, aes(x = type, y = mean, group = Cell, color = Cell))+
geom_line()+
facet_grid(.~target)+
scale_color_brewer(type = "qual", palette = 3)
ggplot(data5, aes(x = type, y = mean, group = Cell, color = Cell))+
geom_line(size = 2)+
facet_grid(.~target)+
scale_color_brewer(type = "qual", palette = 3)
head(data4)
# list.files("S:/Data_Daniel/ActiveProjects/stgmcc/inst/extdata/")
#
# "Preamp_vs_noamp.csv"
# "STG-4genesSeqComp-qPCR.csv"
# "STG-4genesSeqComp-SEQ.csv"
# # "STG_LC_Absolute_Counts_allSTG-GM2f.csv"
#
#
#
#
data1 <- read.csv("S:/Data_Daniel/ActiveProjects/stgmcc/inst/extdata/Preamp_vs_noamp.csv", header = TRUE)
names(data1) <- c("Target", "Sample", "Unamp", "Amp")
plt1 <- ggplot(data1, aes(x = Unamp, y = Amp, color = Target))+
geom_point(size = 5, shape = 1, na.rm = TRUE)+
labs(x = "Unamplified Cq", y = "Amplified Cq")+
xlim(29,37)+
ylim(17,27)
#geom_smooth(method=lm)
plot(plt1)
plt2 <- ggplot(data1, aes(x = Unamp, y = Amp))+
geom_point(size = 5, shape = 1, na.rm = TRUE)+
labs(x = "Unamplified Cq", y = "Amplified Cq")+
xlim(29,37)+
ylim(17,27)+
geom_smooth(method=lm)
plot(plt2)
corrPRE <- cor(data1[,3:4], use="complete.obs", method="pearson")
data2 <- read.csv("S:/Data_Daniel/ActiveProjects/stgmcc/inst/extdata/STG-4genesSeqComp-qPCR.csv", header = TRUE)
data3 <- read.csv("S:/Data_Daniel/ActiveProjects/stgmcc/inst/extdata/STG-4genesSeqComp-SEQ.csv", header = TRUE)
data3 <- data3[, !(names(data3) %in% c("KCNK1",  "NMDA2B", "ChAT", "vAChT"))]
names(data2)[1] <- names(data3)[1] <- "Cell"
names(data3) <- c("Cell", "Sample", "vAChT", "NMDA2B", "ChAT", "KCNK1")
data2$type <- "PCR"
data3$type <- "SEQ"
data4 <- full_join(data2, data3)
# data4 <- gather(data4, "target", "Count", 3:6)
# data4 <- data4[, -2]
# ggplot(data4, aes(x = type, y = Count))+
#   geom_point(size = 5, shape = 1, na.rm = TRUE)+
#   facet_grid(Cell ~ target)
#   # labs(x = "Unamplified Cq", y = "Amplified Cq")+
#   # xlim(29,37)+
#   # ylim(17,27)+
#   # geom_smooth(method=lm)
plot_grid(plotlist = list(
ggplot(data4[data4$type == "SEQ", ], aes(x = Cell, y = ChAT, fill = Cell)) +
geom_boxplot() +
geom_point(size = 2, shape = 1, na.rm = TRUE) + theme(legend.position = "")+     scale_fill_brewer(type = "qual", palette = 3),
ggplot(data4[data4$type == "PCR", ], aes(x = Cell, y = ChAT, fill = Cell)) +
geom_boxplot() +
geom_point(size = 2, shape = 1, na.rm = TRUE) + theme(legend.position = "")+     scale_fill_brewer(type = "qual", palette = 3),
ggplot(data4[data4$type == "SEQ", ], aes(x = Cell, y = vAChT, fill = Cell)) +
geom_boxplot() +
geom_point(size = 2, shape = 1, na.rm = TRUE) + theme(legend.position = "")+     scale_fill_brewer(type = "qual", palette = 3),
ggplot(data4[data4$type == "PCR", ], aes(x = Cell, y = vAChT, fill = Cell)) +
geom_boxplot() +
geom_point(size = 2, shape = 1, na.rm = TRUE) + theme(legend.position = "")+     scale_fill_brewer(type = "qual", palette = 3),
ggplot(data4[data4$type == "SEQ", ], aes(x = Cell, y = NMDA2B, fill = Cell)) +
geom_boxplot() +
geom_point(size = 2, shape = 1, na.rm = TRUE) + theme(legend.position = "")+     scale_fill_brewer(type = "qual", palette = 3),
ggplot(data4[data4$type == "PCR", ], aes(x = Cell, y = NMDA2B, fill = Cell)) +
geom_boxplot() +
geom_point(size = 2, shape = 1, na.rm = TRUE) + theme(legend.position = "")+     scale_fill_brewer(type = "qual", palette = 3),
ggplot(data4[data4$type == "SEQ", ], aes(x = Cell, y = KCNK1, fill = Cell)) +
geom_boxplot() +
geom_point(size = 2, shape = 1, na.rm = TRUE) + theme(legend.position = "")+     scale_fill_brewer(type = "qual", palette = 3),
ggplot(data4[data4$type == "PCR", ], aes(x = Cell, y = KCNK1, fill = Cell)) +
geom_boxplot() +
geom_point(size = 2, shape = 1, na.rm = TRUE) + theme(legend.position = "")+    scale_fill_brewer(type = "qual", palette = 3)
), nrow = 2, ncol = 4)
data4 <- data4[,-2]
for (cell in unique(data4$Cell)){
for (i in 2:5){
data4[data4$type == "PCR" & data4$Cell == cell, i] <- mean(data4[data4$type == "PCR" & data4$Cell == cell, i], na.rm = T)/sd(data4[data4$type == "PCR" & data4$Cell == cell, i], na.rm = T)
data4[data4$type == "SEQ" & data4$Cell == cell, i] <- mean(data4[data4$type == "SEQ" & data4$Cell == cell, i], na.rm = T)/sd(data4[data4$type == "SEQ" & data4$Cell == cell, i], na.rm = T)
}
}
data4 <- data4[!duplicated(data4),]
data4.seq <- data4[data4$type == "SEQ", ]
data4.pcr <- data4[data4$type == "PCR", ]
head(data4)
data5 <- gather(data4, target, mean, 2:5)
ggplot(data5, aes(x = type, y = mean, group = Cell, color = Cell))+
geom_line(size = 2)+
facet_grid(.~target)+
scale_color_brewer(type = "qual", palette = 3)
# list.files("S:/Data_Daniel/ActiveProjects/stgmcc/inst/extdata/")
#
# "Preamp_vs_noamp.csv"
# "STG-4genesSeqComp-qPCR.csv"
# "STG-4genesSeqComp-SEQ.csv"
# # "STG_LC_Absolute_Counts_allSTG-GM2f.csv"
#
#
#
#
data1 <- read.csv("S:/Data_Daniel/ActiveProjects/stgmcc/inst/extdata/Preamp_vs_noamp.csv", header = TRUE)
names(data1) <- c("Target", "Sample", "Unamp", "Amp")
plt1 <- ggplot(data1, aes(x = Unamp, y = Amp, color = Target))+
geom_point(size = 5, shape = 1, na.rm = TRUE)+
labs(x = "Unamplified Cq", y = "Amplified Cq")+
xlim(29,37)+
ylim(17,27)
#geom_smooth(method=lm)
plot(plt1)
plt2 <- ggplot(data1, aes(x = Unamp, y = Amp))+
geom_point(size = 5, shape = 1, na.rm = TRUE)+
labs(x = "Unamplified Cq", y = "Amplified Cq")+
xlim(29,37)+
ylim(17,27)+
geom_smooth(method=lm)
plot(plt2)
corrPRE <- cor(data1[,3:4], use="complete.obs", method="pearson")
data2 <- read.csv("S:/Data_Daniel/ActiveProjects/stgmcc/inst/extdata/STG-4genesSeqComp-qPCR.csv", header = TRUE)
data3 <- read.csv("S:/Data_Daniel/ActiveProjects/stgmcc/inst/extdata/STG-4genesSeqComp-SEQ.csv", header = TRUE)
data3 <- data3[, !(names(data3) %in% c("KCNK1",  "NMDA2B", "ChAT", "vAChT"))]
names(data2)[1] <- names(data3)[1] <- "Cell"
names(data3) <- c("Cell", "Sample", "vAChT", "NMDA2B", "ChAT", "KCNK1")
data2$type <- "PCR"
data3$type <- "SEQ"
data4 <- full_join(data2, data3)
# data4 <- gather(data4, "target", "Count", 3:6)
# data4 <- data4[, -2]
# ggplot(data4, aes(x = type, y = Count))+
#   geom_point(size = 5, shape = 1, na.rm = TRUE)+
#   facet_grid(Cell ~ target)
#   # labs(x = "Unamplified Cq", y = "Amplified Cq")+
#   # xlim(29,37)+
#   # ylim(17,27)+
#   # geom_smooth(method=lm)
plot_grid(plotlist = list(
ggplot(data4[data4$type == "SEQ", ], aes(x = Cell, y = ChAT, fill = Cell)) +
geom_boxplot() +
geom_point(size = 2, shape = 1, na.rm = TRUE) + theme(legend.position = "")+     scale_fill_brewer(type = "qual", palette = 3),
ggplot(data4[data4$type == "PCR", ], aes(x = Cell, y = ChAT, fill = Cell)) +
geom_boxplot() +
geom_point(size = 2, shape = 1, na.rm = TRUE) + theme(legend.position = "")+     scale_fill_brewer(type = "qual", palette = 3),
ggplot(data4[data4$type == "SEQ", ], aes(x = Cell, y = vAChT, fill = Cell)) +
geom_boxplot() +
geom_point(size = 2, shape = 1, na.rm = TRUE) + theme(legend.position = "")+     scale_fill_brewer(type = "qual", palette = 3),
ggplot(data4[data4$type == "PCR", ], aes(x = Cell, y = vAChT, fill = Cell)) +
geom_boxplot() +
geom_point(size = 2, shape = 1, na.rm = TRUE) + theme(legend.position = "")+     scale_fill_brewer(type = "qual", palette = 3),
ggplot(data4[data4$type == "SEQ", ], aes(x = Cell, y = NMDA2B, fill = Cell)) +
geom_boxplot() +
geom_point(size = 2, shape = 1, na.rm = TRUE) + theme(legend.position = "")+     scale_fill_brewer(type = "qual", palette = 3),
ggplot(data4[data4$type == "PCR", ], aes(x = Cell, y = NMDA2B, fill = Cell)) +
geom_boxplot() +
geom_point(size = 2, shape = 1, na.rm = TRUE) + theme(legend.position = "")+     scale_fill_brewer(type = "qual", palette = 3),
ggplot(data4[data4$type == "SEQ", ], aes(x = Cell, y = KCNK1, fill = Cell)) +
geom_boxplot() +
geom_point(size = 2, shape = 1, na.rm = TRUE) + theme(legend.position = "")+     scale_fill_brewer(type = "qual", palette = 3),
ggplot(data4[data4$type == "PCR", ], aes(x = Cell, y = KCNK1, fill = Cell)) +
geom_boxplot() +
geom_point(size = 2, shape = 1, na.rm = TRUE) + theme(legend.position = "")+    scale_fill_brewer(type = "qual", palette = 3)
), nrow = 2, ncol = 4)
data4 <- data4[,-2]
for (cell in unique(data4$Cell)){
for (i in 2:5){
data4[data4$type == "PCR" & data4$Cell == cell, i] <- mean(data4[data4$type == "PCR" & data4$Cell == cell, i], na.rm = T)#/sd(data4[data4$type == "PCR" & data4$Cell == cell, i], na.rm = T)
data4[data4$type == "SEQ" & data4$Cell == cell, i] <- mean(data4[data4$type == "SEQ" & data4$Cell == cell, i], na.rm = T)#/sd(data4[data4$type == "SEQ" & data4$Cell == cell, i], na.rm = T)
}
}
data4 <- data4[!duplicated(data4),]
data4.seq <- data4[data4$type == "SEQ", ]
data4.pcr <- data4[data4$type == "PCR", ]
head(data4)
data5 <- gather(data4, target, mean, 2:5)
ggplot(data5, aes(x = type, y = mean, group = Cell, color = Cell))+
geom_line(size = 2)+
facet_grid(.~target)+
scale_color_brewer(type = "qual", palette = 3)
data4.seq
View(data4.pcr)
View(data4.pcr)
data4.seq[, -6] / data4.pcr[, -6]
data4.seq[, 2:5] / data4.pcr[, 2:5]
data4.ratio <- data4
data4.ratio <- data4.pcr
data4.ratio[, 2:5] <- data4.seq[, 2:5] / data4.pcr[, 2:5]
data4.ratio
data4.pcr
data4.ratio <- data4.pcr[,-6]
data4.ratio[, 2:5] <- data4.seq[, 2:5] / data4.pcr[, 2:5]
gather(data4.ratio, target, seqTOpcr)
gather(data4.ratio, target, seqTOpcr, 2:5)
ggplot(gather(data4.ratio, target, seqTOpcr, 2:5),
aes(x = Cell, y = seqTOpcr, group = Cell, color = Cell))+
geom_line(size = 2)+
facet_grid(.~target)+
scale_color_brewer(type = "qual", palette = 3)
ggplot(gather(data4.ratio, target, seqTOpcr, 2:5),
aes(x = Cell, y = seqTOpcr, group = Cell, color = Cell))+
geom_point(size = 2)+
facet_grid(.~target)+
scale_color_brewer(type = "qual", palette = 3)
data5 <- gather(data4, target, mean, 2:5)
ggplot(data5, aes(x = type, y = mean, group = Cell, color = Cell))+
geom_line(size = 2)+
facet_grid(.~target)+
scale_color_brewer(type = "qual", palette = 3)
ggplot(gather(data4.ratio, target, seqTOpcr, 2:5),
aes(x = Cell, y = seqTOpcr, group = Cell, color = Cell))+
geom_point(size = 2)+
facet_grid(.~target)+
scale_color_brewer(type = "qual", palette = 3)
data5
data6 <- spread(data5, type, mean)
data6
ggplot(data6, aes(x = PCR, y = SEQ, group = Cell, color = Cell))+
geom_line(size = 2)+
facet_grid(.~target)+
scale_color_brewer(type = "qual", palette = 3)
ggplot(data6, aes(x = PCR, y = SEQ, group = Cell, color = Cell))+
geom_point(size = 2)+
#facet_grid(.~target)+
scale_color_brewer(type = "qual", palette = 3)
ggplot(data6, aes(x = PCR, y = SEQ, group = Cell, color = Cell))+
geom_smooth()+
geom_point(size = 2)+
#facet_grid(.~target)+
scale_color_brewer(type = "qual", palette = 3)
ggplot(data6, aes(x = PCR, y = SEQ, color = Cell))+
geom_smooth()+
geom_point(size = 2)+
#facet_grid(.~target)+
scale_color_brewer(type = "qual", palette = 3)
ggplot(data6, aes(x = PCR, y = SEQ, color = Cell))+
geom_smooth(aes(group = 1))+
geom_point(size = 2)+
#facet_grid(.~target)+
scale_color_brewer(type = "qual", palette = 3)
ggplot(data6, aes(x = PCR, y = SEQ, color = Cell))+
geom_smooth(aes(group = 1), method = lm)+
geom_point(size = 2)+
#facet_grid(.~target)+
scale_color_brewer(type = "qual", palette = 3)
ggplot(data6, aes(x = PCR, y = SEQ, color = Cell))+
geom_smooth(aes(group = 1), method = lm)+
geom_point(size = 2)+
facet_grid(.~Cell)+
scale_color_brewer(type = "qual", palette = 3)
ggplot(data6, aes(x = PCR, y = SEQ, color = Cell))+
geom_smooth(, method = lm)+
geom_point(size = 2)+
facet_grid(.~Cell)+
scale_color_brewer(type = "qual", palette = 3)
ggplot(data6, aes(x = PCR, y = SEQ, color = Cell))+
geom_smooth(method = lm)+
geom_point(size = 2)+
facet_grid(.~Cell)+
scale_color_brewer(type = "qual", palette = 3)
ggplot(data6, aes(x = PCR, y = SEQ, color = Cell))+
geom_smooth(method = lm)+
geom_point(size = 2)+
#facet_grid(.~Cell)+
scale_color_brewer(type = "qual", palette = 3)
ggplot(data6, aes(x = PCR, y = SEQ))+
geom_smooth(method = lm)+
geom_point(aes(color = Cell), size = 2)+
#facet_grid(.~Cell)+
scale_color_brewer(type = "qual", palette = 3)
